{% extends 'base.html' %}
{% load static %}

{% block title %}Detalle de All In One{% endblock %}

{% block sidebar %}
  {% include 'componentes/sidebar.html' %}
{% endblock %}

{% block content %}
<div id="content" class="w-full max-w-screen-2xl mx-auto px-4 py-6 md:ml-72">

  <!-- Card -->
  <div class="mx-auto max-w-4xl bg-white rounded-2xl shadow-lg ring-1 ring-black/5 overflow-hidden">

    <!-- Header -->
    <div class="bg-gradient-to-br from-red-600 to-red-700 px-6 py-5">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <h2 class="text-2xl font-bold text-white">Detalle de All In One</h2>

        <!-- Acciones -->
        <div class="flex items-center gap-2 print:hidden">
          <a href="{% url 'all_in_one' %}"
             class="inline-flex items-center gap-2 rounded-xl px-3 py-2 bg-white/10 hover:bg-white/20 text-white text-sm font-semibold transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M10 19 3 12l7-7 1.41 1.41L6.83 11H21v2H6.83l4.58 4.59L10 19z"/></svg>
            Volver
          </a>
        </div>
      </div>
    </div>

    <!-- Body -->
    <div class="px-6 py-6 text-gray-800">

      <!-- Datos principales -->
      <dl class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
        <div>
          <dt class="text-sm text-gray-500 font-semibold">Activo</dt>
          <dd class="font-medium">{{ allinone.activo|default_if_none:"N/A" }}</dd>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Marca</dt>
          <dd class="font-medium">{{ allinone.marca|default_if_none:"N/A" }}</dd>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Modelo</dt>
          <dd class="font-medium">{{ allinone.modelo|default_if_none:"N/A" }}</dd>
        </div>

        <div class="flex items-start justify-between gap-2">
          <div>
            <dt class="text-sm text-gray-500 font-semibold">Número de Serie</dt>
            <dd class="font-medium" id="serie">{{ allinone.n_serie|default_if_none:"N/A" }}</dd>
          </div>
          <button type="button" class="copy-btn shrink-0" data-copy="#serie" title="Copiar">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 hover:text-gray-700" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 17H8V7h11v15z"/></svg>
          </button>
        </div>

        <div class="flex items-start justify-between gap-2">
          <div>
            <dt class="text-sm text-gray-500 font-semibold">UNIVE</dt>
            <dd class="font-medium" id="unive">{{ allinone.unive|default_if_none:"N/A" }}</dd>
          </div>
          <button type="button" class="copy-btn shrink-0" data-copy="#unive" title="Copiar">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 hover:text-gray-700" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 17H8V7h11v15z"/></svg>
          </button>
        </div>

        <div class="flex items-start justify-between gap-2">
          <div>
            <dt class="text-sm text-gray-500 font-semibold">BDO</dt>
            <dd class="font-medium" id="bdo">{{ allinone.bdo|default_if_none:"N/A" }}</dd>
          </div>
          <button type="button" class="copy-btn shrink-0" data-copy="#bdo" title="Copiar">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 hover:text-gray-700" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 17H8V7h11v15z"/></svg>
          </button>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Estado</dt>
          {% with e=allinone.estado|default_if_none:"Desconocido" %}
          <dd>
            <span class="inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm ring-1
              {% if e == 'Activo' or e == 'Operativo' %}
                bg-green-100 text-green-700 ring-green-600/20
              {% elif e == 'En reparación' %}
                bg-amber-100 text-amber-700 ring-amber-600/20
              {% elif e == 'De baja' or e == 'Baja' %}
                bg-red-100 text-red-700 ring-red-600/20
              {% else %}
                bg-gray-100 text-gray-600 ring-gray-500/20
              {% endif %}">
              <span class="h-2 w-2 rounded-full
                {% if e == 'Activo' or e == 'Operativo' %} bg-green-500
                {% elif e == 'En reparación' %} bg-amber-500
                {% elif e == 'De baja' or e == 'Baja' %} bg-red-500
                {% else %} bg-gray-400 {% endif %}"></span>
              {{ e }}
            </span>
          </dd>
          {% endwith %}
        </div>

        <div class="flex items-start justify-between gap-2">
          <div>
            <dt class="text-sm text-gray-500 font-semibold">NetBIOS</dt>
            <dd class="font-medium" id="netbios">{{ allinone.netbios|default_if_none:"N/A" }}</dd>
          </div>
          <button type="button" class="copy-btn shrink-0" data-copy="#netbios" title="Copiar">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500 hover:text-gray-700" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 17H8V7h11v15z"/></svg>
          </button>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Ubicación</dt>
          <dd class="font-medium">{{ allinone.ubicacion|default_if_none:"N/A" }}</dd>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Registrado por</dt>
          <dd class="font-medium">{% firstof allinone.creado_por.get_full_name allinone.creado_por "N/A" %}</dd>
        </div>

        <div>
          <dt class="text-sm text-gray-500 font-semibold">Fecha de Creación</dt>
          <dd class="font-medium">{{ allinone.fecha_creacion|date:"d/m/Y H:i"|default_if_none:"N/A" }}</dd>
        </div>
      </dl>

      <!-- Acciones inferiores -->
      <div class="mt-8 flex flex-col sm:flex-row justify-end gap-3 print:hidden">
        <a href="{% url 'all_in_one' %}"
           class="inline-flex items-center justify-center gap-2 rounded-xl bg-gray-600 hover:bg-gray-700 text-white font-semibold px-4 py-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M10 19 3 12l7-7 1.41 1.41L6.83 11H21v2H6.83l4.58 4.59L10 19z"/></svg>
          Volver a la lista
        </a>
      </div>

    </div>
  </div>
</div>

<!-- Utilidades -->
<style>
  @media print { .print\:hidden { display:none !important; } }
  .copy-btn { padding:.25rem; border-radius:.5rem; }
  .copy-btn:focus { outline:2px solid rgb(59 130 246 / .6); outline-offset:2px; }
</style>

<script>
  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const target = document.querySelector(btn.dataset.copy);
      if (!target) return;
      const text = target.textContent.trim();
      if (!text || text === 'N/A' || text === 'Vacío') return;
      navigator.clipboard.writeText(text).then(() => {
        const prev = btn.title;
        btn.title = '¡Copiado!';
        setTimeout(() => btn.title = prev || 'Copiar', 900);
      });
    });
  });
</script>
{% endblock %}
